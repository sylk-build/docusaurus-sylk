#!/usr/bin/env node

const program = require('commander');
// const chalk = require('chalk');
const path = require('path');
const { default: init } = require('../dist');

function wrapCommand(fn) {
  return (...args) =>
    fn(...args).catch((err) => {
      console.error(err.stack);
      process.exitCode = 1;
    });
}

program
  .version(require('../package.json').version)
  .usage('<command> [options]');


program
  .command('init [siteName]')
  .option('--json <path>', 'A path to sylk.json file')
  // .option('--sylk-json-paths <json...>', 'A path to sylk.json file that will be served on docusaurus')
  .option('--sylk-docs-path <doc>', 'The path for the generated docs')
  .option('--sidebar-path <sidebar>', 'A path to sidebar.js that will be generated by sylk plugin')
  .option('--route-base-path <route>', 'The served docs base route')
  .description('Initialize Docusaurus website with Sylk preset.')
  .action((siteName = 'sylk-project', options) => {
    wrapCommand(init)(siteName,options);
  });

program.arguments('<command>').action((cmd) => {
  program.outputHelp();
  console.log(`  ${`\n  Unknown command ${cmd}.`}`);
  console.log();
});

program.parse(process.argv);

if (!process.argv.slice(2).length) {
  program.outputHelp();
}